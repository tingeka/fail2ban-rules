#
# Fail2Ban action configuration for Cloudflare Firewall Logger
#
# This action logs ban/unban events to domain-specific files that can be
# processed by a separate script to interact with the Cloudflare API.
#

[INCLUDES]

before = iptables-common.conf

[Definition]

# Command executed when the jail starts
actionstart = /usr/local/bin/f2b-action-cloudflare-firewall-logger.sh start <name> <domain>

# Command executed when the jail stops  
actionstop = /usr/local/bin/f2b-action-cloudflare-firewall-logger.sh stop <name> <domain>

# Command executed when banning an IP
actionban = /usr/local/bin/f2b-action-cloudflare-firewall-logger.sh ban <name> <domain> <ip> <bantime>

# Command executed when unbanning an IP
actionunban = /usr/local/bin/f2b-action-cloudflare-firewall-logger.sh unban <name> <domain> <ip> <bantime>

# Command to check if IP is currently banned (optional)
actioncheck = 

[Init]

# Default target domain - this should be overridden in jail configuration
domain = 