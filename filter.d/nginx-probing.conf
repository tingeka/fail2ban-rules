[Definition]
# Regex pattern for nginx log format with upstream fields
# $upstream_response_time: - or float (e.g., 0.490)
# $upstream_cache_status: -, HIT, BYPASS, or MISS

failregex =
# .env probes
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*\.env[^"]*\s+HTTP/[^"]*"\s+\d+.*$

# CGI‑bin attacks
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*/cgi-bin/[^"]*".*$

# proc/self/environ attacks
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*proc/self/environ[^"]*".*$

# Mozi botnet probes (case‑insensitive)
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*[Mm][Oo][Zz][Ii][^"]*".*$

# wget scans
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*[Ww][Gg][Ee][Tt][^"]*".*$

# curl scans
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*[Cc][Uu][Rr][Ll][^"]*".*$

# code‑injection attempts
  #<HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*(eval|base64|shell_exec|passthru)[^"]*".*$
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*[\?&]\w*=(eval|base64|shell_exec|passthru)\b[^"]*".*$

# PHP‑file probes
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*(wp-config\.php|phpinfo\.php|adminer\.php)[^"]*".*$

# AWS‑enum probes
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*\.aws[^"]*".*$

# Hello Dolly WP exploit
  <HOST>\s+\S+\s+\S+\s+\S+\s+"(GET|POST)\s+[^"]*hello_dolly_v2\.php[^"]*".*$

ignoreregex =